@page "/"
@inject IDialogService DialogService
@inject NavigationManager _navigationManager;

<MudGrid Class="align-center" @ref=this.grid>
    @if (Workouts != null)
    {
        @foreach (var workout in Workouts)
        {
            <MudButton OnClick="() => NavigateToWorkoutPage(workout.Id)">
                <WorkoutItemComponent WorkoutName="@workout.Name" Difficulty="@workout.Difficulty" />
            </MudButton>    
        }
    }
    else
    {
        <p>Loading...</p>
    }
    <MudItem md="2" sm="4" xs="6">
        <MudFab OnClick="@OpenDialog" Color="Color.Primary" StartIcon="@Icons.Material.Filled.Add" />
    </MudItem>
</MudGrid>

@code {
    [Inject]
    LocalStorageService LocalStorageService { get; set; }
    public List<Workout> Workouts { get; set; }
    private MudGrid grid;

    protected override async Task OnInitializedAsync()
    {
        Workouts = await LocalStorageService.GetItemAsync<List<Workout>>("workouts");
    }

    private async Task OpenDialog()
    {
        var result = await DialogService.ShowAsync<CreateWorkoutDialogComponent>();
    }

    private void NavigateToWorkoutPage(int id)
    {
        _navigationManager.NavigateTo("/exercise/" + id,true);
    }
}